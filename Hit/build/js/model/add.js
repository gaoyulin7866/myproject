function errorNotify(t,a,o){null==t&&(t="错误信息："),null==o&&(o="danger"),$.notify({title:t,message:a},{type:o,z_index:99999,template:'<div data-notify="container" class="alert alert-{0}" role="alert"><span data-notify="icon"></span> <span data-notify="title">{1}</span> <span data-notify="message">{2}</span><div class="progress" data-notify="progressbar"><div class="progress-bar progress-bar-{0}" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div></div><a href="{3}" target="{4}" data-notify="url"></a></div>'})}var TempUrl="http://42.159.123.51:8087/";Obligate_4_Array=[];for(var strVersions="",strColNum="",strObligate_1="",strObligate_2="",strObligate_3="",strObligate_4="",i=1;i<=10;i++)strColNum+='<option value="'+i+'">'+i+"个</option>";$.ajax({type:"get",url:TempUrl+"hit/getVersions.action?type=2&app_or_por=2",contentType:"application/x-www-form-urlencoded",dataType:"json",success:function(t){$.each(t,function(t,a){strVersions+='<option value="'+a.id+'">'+a.v_name+"</option>"}),$.ajax({type:"get",url:TempUrl+"hit/getObligate.action?type=1,2,3,4&app_or_por=2",contentType:"application/x-www-form-urlencoded",dataType:"json",success:function(t){$.each(t,function(t,a){switch(parseInt(a.type)){case 1:strObligate_1+='<option data-support="'+a.ename+'" value="'+a.id+'">'+a.name+"</option>";break;default:return"-"}});var a="";a+='<div class="row" id="VueDiv"><div class="col-sm-12"><div class="form-horizontal" id="">',a+='<br><div class="form-group"><label class="col-sm-3 control-label"><i class="fa fa-asterisk"></i>portal版本</label><div id="tihuan" class="col-sm-6"><select id="HitV2" name="HitV2" class="selectpicker form-control" data-live-search="true"><option value="">选择版本</option>'+strVersions+'</select></div><div class="col-sm-2"><p class="form-control-static" style="display:inline-block;margin-right:15px;"><i class="fa fa-plus-circle" v-on:click="version_add(2)" data-toggle="tooltip" data-placement="top"></i></p><p class="form-control-static"  style="display:inline-block;margin-right:15px;"><i v-on:click="version_del(1)" class="fa fa-minus-circle"></i></p></div></div>',a+='<div class="form-group"><label class="col-sm-3 control-label">版本日期</label><div class="col-sm-6"><div class="input-group date" id="datetimepicker"><input type="text" id="versiondate2" class="form-control" readonly><span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span></div></div></div>',a+='<div class="form-group"><label class="col-sm-3 control-label"><i class="fa fa-asterisk"></i> 页别</label><div class="col-sm-3"><select id="Obligate_1_2" name="Obligate_1_2" class="selectpicker col-sm-4 form-control" data-live-search="true"><option value="">选择页别</option>'+strObligate_1+'</select></div><div class="col-sm-3"><input  id="Obligate_1_2_en"  type="text" class="form-control" readonly="readonly"></div><div class="col-sm-2"><p class="form-control-static"  style="display:inline-block;margin-right:15px;"><i v-on:click="style_add(\'1\')" class="fa fa-plus-circle"></i></p><p class="form-control-static"  style="display:inline-block;margin-right:15px;"><i v-on:click="version_del(3)" class="fa fa-minus-circle"></i></p><p class="form-control-static"  style="display:inline-block;margin-right:15px;"><i class="fa fa-exclamation-circle"  data-toggle="tooltip" data-placement="top" title="页别，类别，预留维度要有1,2,3级菜单级联关系"></i></p></div></div>',a+='<div class="form-group"><label class="col-sm-3 control-label"><i class="fa fa-asterisk"></i>hit名称</label><div class="col-sm-3"><input type="text" id="HitName2" name="HitName2" class="form-control" placeholder="请输入名称"></div><div class="col-sm-3"><input type="text" id="HitNameE2" name="HitNameE2" class="form-control" placeholder="请输入英文名"></div><div class="col-sm-2"><p class="form-control-static"><i class="fa fa-exclamation-circle"  data-toggle="tooltip" data-placement="top" title="不超过10个的字母，需验证版本号和该字段组合唯一"></i></p></div></div>',a+='<div class="form-group"><label class="col-sm-3 control-label">hit id</label><div class="col-sm-6"><input type="text" id="HitId2" name="HitId2" class="form-control" readonly></div><div class="col-sm-3"><button v-on:click="dadian_add()" class="btn btn-primary">生成事件</button></div></div>',a+='<div class="form-group"><label class="col-sm-3 control-label">事件ID</label><div class="col-sm-6"><input type="text" id="HitEventID2" name="HitEventID2" class="form-control" readonly></div></div>',a+='<div class="form-group"><label class="col-sm-3 control-label"><i class="fa fa-asterisk"></i>行为类型</label><div class="col-sm-6"><select id="ActionType2" name="ActionType2" class="selectpicker form-control" data-live-search="true"><option value="">选择类型</option><option value="1">user_click</option><option value="2">user_pageview</option><option value="3">user_system</option><option value="4">ad_impression</option><option value="5">ad_click</option><option value="6">error_device</option><option value="7">error_cloud</option><option value="8">business_feedback</option></select></div></div>',a+='<div class="form-group"><label class="col-sm-3 control-label">描述</label><div class="col-sm-6"><textarea type="textarea" class="form-control" id="Describe2" name="Describe2"></textarea></div></div>',a+='<div class="form-group"><label class="col-sm-3 control-label">状态</label><div class="col-sm-6"><select id="Status2" name="Status2" class="selectpicker form-control" data-live-search="true"><option value="1">已下线</option><option value="2">正常使用</option><option value="3">新增打点</option></select></div></div>',a+='<div class="form-group"><label class="col-sm-3 control-label">扩展字段说明</label><div class="col-sm-6"><textarea id="por_col1" type="textarea" class="form-control"></textarea></div></div>',a+='<div class="form-group"><label class="col-sm-3 control-label">refhit</label><div class="col-sm-6"><select id="Refhitid2" name="Refhitid2" class="selectpicker form-control"><option value="1">是</option><option value="2">否</option></select></div></div>',a+='<div class="form-group"><div class="col-sm-12" style="text-align: center;"><button v-on:click="reset()" class="btn btn-primary">重置</button>&nbsp;&nbsp;&nbsp;<button v-on:click="submit()" class="btn btn-primary">提交</button></div></div>',a+="</div></div></div>",$("#table-portal").html(a),new Vue({el:"#VueDiv",data:{todos:Obligate_4_Array},mounted:function(){$(".selectpicker").selectpicker("refresh"),$('[data-toggle="tooltip"]').tooltip(),$("#datetimepicker").datetimepicker({format:"yyyy-mm-dd",weekStart:1,autoclose:!0,minView:"month",language:"zh-CN"})},methods:{style_add:function(t){var a="";switch(parseInt(t)){case 1:a="页别";break;default:return"-"}var o="";o+='<div class="row"><div class="col-sm-12"><div class="form-horizontal" id="FormValidator2">',o+='<div class="form-group"><label class="col-sm-3 control-label">中文名称</label><div class="col-sm-8"><input type="text" id="name2" name="name2" class="form-control"></div></div>',o+='<div class="form-group"><label class="col-sm-3 control-label">英文名称</label><div class="col-sm-8"><input type="text" id="ename2" name="ename2" class="form-control"></div></div>',o+="</div></div></div>",BootstrapDialog.show({title:"新增"+a,message:o,onshown:function(t){$("#FormValidator2").bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{name2:{message:"中文名无效",validators:{notEmpty:{message:"请输入中文名"}}},ename2:{message:"英文名无效",validators:{notEmpty:{message:"请输入英文名"}}}}})},buttons:[{label:"提交",cssClass:"btn-primary",action:function(a){if($("#FormValidator2").bootstrapValidator("validate"),$("#FormValidator2").data("bootstrapValidator").isValid()){var o=new Object;o.name=$("#name2").val(),o.ename=$("#ename2").val(),o.type=t,o.app_or_por=2,$.ajax({type:"post",url:TempUrl+"hit/addObligate.action",timeout:6e4,dataType:"json",data:o,success:function(t){var o="";o=t.message,6e5==t.result?(errorNotify("",o,"info"),a.close()):errorNotify("",o)},error:function(t,a,o){"timeout"==a&&BootstrapDialog.show({title:"系统提示",message:"请求超时！",buttons:[{label:"关闭",action:function(t){t.close()}}]})}})}else BootstrapDialog.alert({title:"验证失败",message:"请确认输入内容格式是否正确！",type:BootstrapDialog.TYPE_DANGER,buttonLabel:"确认"})}}]})},dadian_add:function(){var t=$("#HitV2").val(),a=$("#Obligate_1_2_en").val(),o="";if(""==t)return errorNotify("","请选择版本"),!1;if(""==$("#HitNameE2").val())return errorNotify("","请输入英文名"),!1;o=$("#HitNameE2").val(),""!=a?$("#HitId2").val(a+"."+o):errorNotify("","请选择页别");var e="app_hitV="+t+"&hitId="+$("#HitId2").val()+"&app_or_por=2";$.ajax({type:"post",contentType:"application/x-www-form-urlencoded",url:TempUrl+"hit/verifyHitId.action",timeout:6e4,dataType:"json",data:e,success:function(t){var a="",o=(a=t.message).split("_");a=o[0];var e=o[1];600025==t.result?$("#HitEventID2").val(e):(errorNotify("",a),$("#HitId2,#HitEventID2").val(""))},error:function(t,a,o){"timeout"==a&&BootstrapDialog.show({title:"系统提示",message:"请求超时！",buttons:[{label:"关闭",action:function(t){t.close()}}]})}})},version_add:function(t){var a="";a+='<div class="row"><div class="col-sm-12"><div class="form-horizontal" id="FormValidator2">',a+='<div class="form-group"><label class="col-sm-3 control-label">版本名称</label><div class="col-sm-8"><input type="text" id="versionName3" name="versionName3" class="form-control" placeholder="请输入版本名称"></div></div>',a+='<div class="form-group"><label class="col-sm-3 control-label">版本状态</label><div class="col-sm-8"><select id="versionState3" name="versionState3" class="selectpicker form-control" data-live-search="true"><option value="1">新增版本</option><option value="2">稳定版本</option><option value="3">下线版本</option></select></div></div>',a+="</div></div></div>",BootstrapDialog.show({title:"新增版本",message:a,onshown:function(t){$(".selectpicker").selectpicker("refresh")},buttons:[{label:"提交",cssClass:"btn-primary",action:function(a){if(""==$("#versionName3").val())return errorNotify(null,"请输入版本名称！"),!1;if(""==$("#versionState3").val())return errorNotify(null,"请选择状态！"),!1;var o=new Object;o.v_name=$("#versionName3").val(),o.v_type=$("#versionState3").val(),o.app_or_por=t,$.ajax({type:"get",url:TempUrl+"hit/verifyVersion.action?v_name="+o.v_name+"&app_or_por="+t,timeout:6e4,dataType:"json",success:function(t){var e="";e=t.message,600025==t.result?($("#table-app").bootstrapTable("refreshOptions",{pageNumber:1}),errorNotify("",e,"info"),a.close()):errorNotify("",e=t.message),$.ajax({type:"post",url:TempUrl+"hit/addVersion.action",timeout:6e4,dataType:"json",data:o,success:function(t){var o="";o=t.message,6e5==t.result?(errorNotify("",o,"info"),a.close()):errorNotify("",o=t.message)},error:function(t,a,o){"timeout"==a&&BootstrapDialog.show({title:"系统提示",message:"请求超时！",buttons:[{label:"关闭",action:function(t){t.close()}}]})}})},error:function(t,a,o){"timeout"==a&&BootstrapDialog.show({title:"系统提示",message:"请求超时！",buttons:[{label:"关闭",action:function(t){t.close()}}]})}})}}]})},version_del:function(t){var a;1==t&&(a=$("#HitV2").val()),3==t&&(a=$("#Obligate_1_2").val()),$.ajax({type:"get",url:"http://42.159.123.51:8087/hit/removeOption.action?ids="+a+"&order="+t,contentType:"application/x-www-form-urlencoded",success:function(t){var a="";a=t.message,600002==t.result?errorNotify("",a,"info"):errorNotify("",a=t.message)},error:function(t,a,o){"timeout"==a&&BootstrapDialog.show({title:"系统提示",message:"请求超时！",buttons:[{label:"关闭",action:function(t){t.close()}}]})}})},reset:function(){$("#versiondate2").val(""),$("#HitName2").val(""),$("#HitNameE2").val(""),$("#Describe2").val(""),$("#HitId2").val(""),$("#HitEventID2").val(""),$("#por_col1").val("")},submit:function(){var t=new Object;return t.por_hitV=$("#HitV2").val(),t.por_versiondate=$("#versiondate2").val(),t.por_createtime=moment().format("HH:mm:ss"),t.por_page=$("#Obligate_1_2").val(),t.por_hitname=$("#HitName2").val(),t.por_hitnameE=$("#HitNameE2").val(),t.por_actiontype=$("#ActionType2").val(),t.por_describe=$("#Describe2").val(),t.por_hitID=$("#HitId2").val(),t.por_hitEventID=$("#HitEventID2").val(),t.por_status=$("#Status2").val(),t.por_col1=$("#por_col1").val(),t.por_refhitid=$("#Refhitid2").val(),""==t.por_hitV?(errorNotify("","请选择版本"),!1):""==t.por_page?(errorNotify("","请选择页别"),!1):""==t.por_hitname?(errorNotify("","请输入名称"),!1):""==t.por_hitnameE?(errorNotify("","请输入英文名"),!1):""==t.por_hitID?(errorNotify("","请生成打点Id"),!1):""==t.por_actiontype?(errorNotify("","请选择行为类型"),!1):void $.ajax({type:"post",url:TempUrl+"hit/addPortal.action",timeout:6e4,dataType:"json",data:t,success:function(t){var a="";a=t.message,6e5==t.result?($("#table-portal").bootstrapTable("refreshOptions",{pageNumber:1}),errorNotify("",a,"info")):errorNotify("",a=t.message)},error:function(t,a,o){"timeout"==a&&BootstrapDialog.show({title:"系统提示",message:"请求超时！",buttons:[{label:"关闭",action:function(t){t.close()}}]})}})}}}),$("#Obligate_1_2").change(function(){$("#Obligate_1_2_en").val($(this).find("option:selected").attr("data-support")),$("#HitId2,#HitEventID2").val("")})},error:function(){errorNotify(null,"无法获取信息！")}})},error:function(){errorNotify(null,"无法获取版本信息！")}});